{"ast":null,"code":"import { coinFlip, randRange } from '../../../utils/functions';\nimport { complex, sqrt, exp, sin, cos, add, subtract, multiply, divide } from 'mathjs';\nimport { atan, acos, pow } from 'mathjs';\nconst A0 = 1.0;\nexport function getFactorial(n) {\n  if (n <= 0) {\n    return 1;\n  } else {\n    var soln = 1;\n    for (var i = 0; i < n; i++) {\n      soln *= i + 1;\n    }\n    return soln;\n  }\n}\n;\nexport function getDoubleFactorial(n) {\n  if (n <= 0) {\n    return 1;\n  } else {\n    var soln = 1;\n    for (var i = 0; i < n; i++) {\n      if (i + 1 % 2 == n % 2) {\n        soln *= i + 1;\n      }\n    }\n    return soln;\n  }\n}\n;\nexport function choose(n, k) {\n  return getFactorial(n) / (getFactorial(n - k) * getFactorial(k));\n}\n;\nexport function mapToSpherical(x, y, z) {\n  var rho = sqrt(x * x + y * y + z * z);\n  var theta = atan(y / x);\n  var phi = acos(z / rho);\n  ;\n  return [rho, theta, phi];\n}\nexport function getNormalization(n, l) {\n  var constTerm = sqrt(pow(2 / (n * A0), 3) * getFactorial(n - l - 1) / (2 * n * getFactorial(n + l)));\n  var radius = rho => 2 * rho / (n * A0);\n  return rho => constTerm * exp(radius(rho) / -2) * pow(radius(rho), l);\n}\n;\nexport function getLaguerrePolynomial(n, l) {\n  var kl = 2 * l + 1;\n  var nl = n - l - 1;\n  return rho => {\n    var signedPower = 1;\n    var total = 0;\n    for (var i = 0; i <= n; i++) {\n      total += signedPower * getFactorial(nl + kl) / (getFactorial(nl - i) * getFactorial(kl + i) * getFactorial(i));\n      signedPower *= -rho;\n    }\n    var constTerm = sqrt(pow(2 / (n * A0), 3) * getFactorial(n - l - 1) / (2 * n * getFactorial(n + l)));\n    var radius = 2 * rho / (n * A0);\n    return total * constTerm * exp(radius / -2) * pow(radius, l);\n  };\n}\n;\nexport function getLegendrePolynomial(l, m) {\n  return rho => {\n    var sign = m % 2 == 0 ? 1 : -1;\n    var base = sign * getDoubleFactorial(2 * m - 1) * pow(1 - rho * rho, m / 2);\n    var nextBase = (2 * m + 1) * rho * base;\n    if (l - m == 0) {\n      return base;\n    } else if (l - m == 1) {\n      return nextBase;\n    } else if (l - m >= 2) {\n      for (var i = 0; i < l - m - 1; i++) {\n        var nextPolynomial = ((2 * l + 1) * nextBase - (l + m) * base) / (l - m + 1);\n        base = nextBase;\n        nextBase = nextPolynomial;\n      }\n      return nextPolynomial;\n    }\n  };\n}\n;\nexport function getSphericalHarmonic(l, m) {\n  var sign = complex(m % 2 == 0 ? 1 : -1, 0);\n  var normalization = complex(sqrt(getFactorial(l - m) * (2 * l + 1) / (getFactorial(l + m) * 4 * Math.PI)), 0);\n  var complexTerm = phi => exp(complex(0, m * phi));\n  return phi => multiply(sign, normalization, complexTerm(phi));\n}\n;\nfunction getFunctional(n, l, m) {\n  return (x, y, z) => {\n    var sphericals = mapToSpherical(x, y, z);\n    var rho = sphericals[0];\n    var theta = sphericals[1];\n    var phi = sphericals[2];\n    return multiply(getLaguerrePolynomial(n, l)(rho), getLegendrePolynomial(l, m)(cos(theta)), getSphericalHarmonic(l, m)(phi));\n  };\n}\nfunction getGradient(n, l, m) {\n  var delta = 0.01;\n  // TODO: Explicitly calculate functions for less computational load\n  return (x, y, z) => {\n    var sphericals = mapToSpherical(x, y, z);\n    var rho = sphericals[0];\n    var theta = sphericals[1];\n    var phi = sphericals[2];\n    var deltaRho = divide(subtract(getLaguerrePolynomial(n, l)(rho + delta / 2), getLaguerrePolynomial(n, l)(rho - delta / 2)), delta);\n    var deltaTheta = divide(subtract(getLegendrePolynomial(l, m)(theta + delta / 2), getLegendrePolynomial(l, m)(theta - delta / 2)), delta * rho);\n    var deltaPhi = divide(subtract(getSphericalHarmonic(l, m)(phi + delta / 2), getSphericalHarmonic(l, m)(phi - delta / 2)), delta * rho * Math.sin(theta));\n    var unitRho = [sin(theta) * cos(phi), sin(theta) * sin(phi), cos(theta)];\n    var unitTheta = [cos(theta) * cos(phi), cos(theta) * sin(phi), sin(theta) * -1];\n    var unitPhi = [sin(phi) * -1, cos(phi), 0];\n    return [add(multiply(unitRho[0], deltaRho), multiply(unitTheta[0], deltaTheta), multiply(unitPhi[0], deltaPhi)), add(multiply(unitRho[1], deltaRho), multiply(unitTheta[1], deltaTheta), multiply(unitPhi[1], deltaPhi)), add(multiply(unitRho[2], deltaRho), multiply(unitTheta[2], deltaTheta), multiply(unitPhi[2], deltaPhi))];\n  };\n}\nfunction getEnergyLevel(n) {\n  return 1.0 / (n * n);\n}\nclass Particle {\n  constructor(x, y, z) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n  }\n  move(dx, dy, dz) {\n    this.x += dx;\n    this.y += dy;\n    this.z += dz;\n  }\n  set(dx, dy, dz) {\n    this.x = dx;\n    this.y = dy;\n    this.z = dz;\n  }\n}\nconst Atom = class {\n  constructor(props) {\n    this.superposition = props.superposition;\n    this.particleCount = props.particleCount;\n    this.boxSize = props.boxSize;\n    this.timer = 0;\n    this.particles = [];\n    while (this.particles.length < props.particleCount) {\n      var newParticle = new Particle(randRange(props.boxSize * -1, props.boxSize), randRange(props.boxSize * -1, props.boxSize), randRange(props.boxSize * -1, props.boxSize));\n      if (coinFlip(1000000 * this.getProbabilityDistribution(newParticle.x, newParticle.y, newParticle.z, 0))) {\n        this.particles.push(newParticle);\n      }\n    }\n  }\n  getWavefunction(x, y, z, t) {\n    var total = 0;\n    for (var i = 0; i < this.superposition.length; i++) {\n      var phase = exp(complex(0, getEnergyLevel(this.superposition[i].n) * t));\n      total = add(total, multiply(phase, this.superposition[i].weight, getFunctional(this.superposition[i].n, this.superposition[i].l, this.superposition[i].m)(x, y, z)));\n    }\n    return total;\n  }\n  getProbabilityDistribution(x, y, z, t) {\n    var wavefunction = this.getWavefunction(x, y, z, t);\n    var wavefunctionC = wavefunction.conjugate();\n    return wavefunction * wavefunctionC;\n  }\n  getWavefunctionGradient(x, y, z, t) {\n    var total = [0, 0, 0];\n    for (var i = 0; i < this.superposition.length; i++) {\n      var phase = exp(complex(0, getEnergyLevel(this.superposition[i].n) * t));\n      var grad = multiply(phase, this.superposition[i].weight, getGradient(this.superposition[i].n, this.superposition[i].l, this.superposition[i].m)(x, y, z));\n      total[0] = add(total[0], grad[0]);\n      total[1] = add(total[1], grad[1]);\n      total[2] = add(total[2], grad[2]);\n    }\n    return total;\n  }\n  getVelocity(x, y, z, t) {\n    var wavefunction = this.getWavefunction(x, y, z, t);\n    var wavefunctionC = wavefunction.conjugate();\n    var gradient = this.getWavefunctionGradient(x, y, z, t);\n    var gradientC = [gradient[0].conjugate(), gradient[1].conjugate(), gradient[2].conjugate()];\n    var velocity = [divide(subtract(multiply(wavefunction, gradientC[0]), multiply(wavefunctionC, gradient[0])), multiply(wavefunction, wavefunctionC)), divide(subtract(multiply(wavefunction, gradientC[1]), multiply(wavefunctionC, gradient[1])), multiply(wavefunction, wavefunctionC)), divide(subtract(multiply(wavefunction, gradientC[2]), multiply(wavefunctionC, gradient[2])), multiply(wavefunction, wavefunctionC))];\n    return velocity;\n  }\n  update(increment) {\n    var deltat = 0.001;\n    var p = this.particles[0];\n    for (var i = 0; i < this.particles.length; i++) {\n      var p = this.particles[i];\n      var velocity = this.getVelocity(p.x, p.y, p.z, this.timer);\n      var oldNorm = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n      p.move(velocity[0].im * deltat, velocity[1].im * deltat, velocity[2].im * deltat);\n      var newNorm = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n      p.set(p.x * oldNorm / newNorm, p.y * oldNorm / newNorm, p.z * oldNorm / newNorm);\n    }\n    this.timer += 1;\n    return this;\n  }\n};\nexport default Atom;","map":{"version":3,"names":["coinFlip","randRange","complex","sqrt","exp","sin","cos","add","subtract","multiply","divide","atan","acos","pow","A0","getFactorial","n","soln","i","getDoubleFactorial","choose","k","mapToSpherical","x","y","z","rho","theta","phi","getNormalization","l","constTerm","radius","getLaguerrePolynomial","kl","nl","signedPower","total","getLegendrePolynomial","m","sign","base","nextBase","nextPolynomial","getSphericalHarmonic","normalization","Math","PI","complexTerm","getFunctional","sphericals","getGradient","delta","deltaRho","deltaTheta","deltaPhi","unitRho","unitTheta","unitPhi","getEnergyLevel","Particle","constructor","move","dx","dy","dz","set","Atom","props","superposition","particleCount","boxSize","timer","particles","length","newParticle","getProbabilityDistribution","push","getWavefunction","t","phase","weight","wavefunction","wavefunctionC","conjugate","getWavefunctionGradient","grad","getVelocity","gradient","gradientC","velocity","update","increment","deltat","p","oldNorm","im","newNorm"],"sources":["/Users/joeyzhu/Projects/joey-j-zhu.github.io/src/components/fold/fold-graphics/atom.js"],"sourcesContent":["import { coinFlip, \n    randRange, \n  } from '../../../utils/functions';\nimport { complex, sqrt, exp, sin, cos, add, subtract, multiply, divide } from 'mathjs';\nimport { atan, acos, pow } from 'mathjs';\n\nconst A0 = 1.0;\n\n\nexport function getFactorial(n) {\n    if (n <= 0) {\n        return 1;\n    } else {\n        var soln = 1;\n        for (var i = 0; i < n; i++) {\n            soln *= i + 1;\n        }\n        return soln;\n    }\n};\n\nexport function getDoubleFactorial(n) {\n    if (n <= 0) {\n        return 1;\n    } else {\n        var soln = 1;\n        for (var i = 0; i < n; i++) {\n            if (i + 1 % 2 == n % 2) {\n                soln *= i + 1;\n            }\n        }\n        return soln;\n    }\n};\n\nexport function choose(n, k) {\n    return getFactorial(n) / (getFactorial(n - k) * getFactorial(k));\n};\n\nexport function mapToSpherical(x, y, z) {\n    var rho = sqrt(x * x + y * y + z * z);\n    var theta = atan(y / x);\n    var phi = acos(z / rho);\n   ; return [rho, theta, phi];\n}\n\nexport function getNormalization(n, l) {\n    var constTerm = sqrt(pow(2 / (n * A0), 3) * getFactorial(n - l - 1) / (2 * n * getFactorial(n + l)));\n    var radius = (rho) => (2 * rho) / (n * A0);\n    return (rho) => constTerm * exp(radius(rho) / -2) * pow(radius(rho), l);\n};\n\n\nexport function getLaguerrePolynomial(n, l) {\n    var kl = 2 * l + 1;\n    var nl = n - l - 1;\n\n    return (rho) => {\n        var signedPower = 1;\n        var total = 0;\n        for (var i = 0; i <= n; i++) {\n            total += signedPower * getFactorial(nl + kl) / (getFactorial(nl - i) * getFactorial(kl + i) * getFactorial(i));\n            signedPower *= -rho;\n        }\n        var constTerm = sqrt(pow(2 / (n * A0), 3) * getFactorial(n - l - 1) / (2 * n * getFactorial(n + l)));\n        var radius = (2 * rho) / (n * A0);\n        return total * constTerm * exp(radius / -2) * pow(radius, l);\n    }\n};\n\nexport function getLegendrePolynomial(l, m) {\n    return (rho) => {\n        var sign = m % 2 == 0 ? 1 : -1;\n        var base = sign * getDoubleFactorial(2 * m - 1) * pow(1 - rho * rho, m / 2);\n        var nextBase = (2 * m + 1) * rho * base;\n        if (l - m == 0) {\n            return base;\n        } else if (l - m == 1) {\n            return nextBase;\n        } else if (l - m >= 2) {\n            for (var i = 0; i < l - m - 1; i++) {\n                var nextPolynomial = ((2 * l + 1) * nextBase - (l + m) * base) / (l - m + 1);\n                base = nextBase;\n                nextBase = nextPolynomial;\n            }\n            return nextPolynomial;\n        }\n    }\n};\n\nexport function getSphericalHarmonic(l, m) {\n    var sign = complex(m % 2 == 0 ? 1 : -1, 0);\n    var normalization = complex(sqrt((getFactorial(l - m) * (2 * l + 1)) / (getFactorial(l + m) * 4 * Math.PI)), 0);\n    var complexTerm = (phi) => exp(complex(0, m * phi));\n\n    return (phi) => multiply(sign, normalization, complexTerm(phi));\n};\n\nfunction getFunctional(n, l, m) {\n    return (x, y, z) => {\n        var sphericals = mapToSpherical(x, y, z);\n        var rho = sphericals[0];\n        var theta = sphericals[1];\n        var phi = sphericals[2];\n        \n        return multiply(getLaguerrePolynomial(n, l)(rho), getLegendrePolynomial(l, m)(cos(theta)), getSphericalHarmonic(l, m)(phi));\n    };\n}\n\nfunction getGradient(n, l, m) {\n\n    var delta = 0.01;\n    // TODO: Explicitly calculate functions for less computational load\n    return (x, y, z) => {\n        var sphericals = mapToSpherical(x, y, z);\n        var rho = sphericals[0];\n        var theta = sphericals[1];\n        var phi = sphericals[2];\n\n        var deltaRho = divide(subtract(getLaguerrePolynomial(n, l)(rho + delta / 2), getLaguerrePolynomial(n, l)(rho - delta / 2)), (delta));\n        var deltaTheta = divide(subtract(getLegendrePolynomial(l, m)(theta + delta / 2), getLegendrePolynomial(l, m)(theta - delta / 2)), (delta * rho));\n        var deltaPhi = divide(subtract(getSphericalHarmonic(l, m)(phi + delta / 2), getSphericalHarmonic(l, m)(phi - delta / 2)), (delta * rho * Math.sin(theta)));\n\n        var unitRho = [sin(theta) * cos(phi), sin(theta) * sin(phi), cos(theta)];\n        var unitTheta = [cos(theta) * cos(phi), cos(theta) * sin(phi), sin(theta) * -1];\n        var unitPhi = [sin(phi) * -1, cos(phi), 0];\n\n        return [\n            add(multiply(unitRho[0], deltaRho), multiply(unitTheta[0], deltaTheta), multiply(unitPhi[0], deltaPhi)),\n            add(multiply(unitRho[1], deltaRho), multiply(unitTheta[1], deltaTheta), multiply(unitPhi[1], deltaPhi)),\n            add(multiply(unitRho[2], deltaRho), multiply(unitTheta[2], deltaTheta), multiply(unitPhi[2], deltaPhi)),\n        ];\n    }\n}\n\nfunction getEnergyLevel(n) {\n    return 1.0 / (n * n);\n}\n\n\nclass Particle {\n    constructor(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    move(dx, dy, dz) {\n        this.x += dx;\n        this.y += dy;\n        this.z += dz;\n    }\n\n    set(dx, dy, dz) {\n        this.x = dx;\n        this.y = dy;\n        this.z = dz;\n    }\n}\n\n\nconst Atom = class {\n    constructor (props) {\n        this.superposition = props.superposition;\n        this.particleCount = props.particleCount;\n        this.boxSize = props.boxSize;\n        this.timer = 0;\n\n        this.particles = [];\n        \n        while (this.particles.length < props.particleCount) {\n            var newParticle = new Particle(\n                randRange(props.boxSize * -1, props.boxSize),\n                randRange(props.boxSize * -1, props.boxSize),\n                randRange(props.boxSize * -1, props.boxSize),\n            );\n            if (coinFlip(1000000 * this.getProbabilityDistribution(newParticle.x, newParticle.y, newParticle.z, 0))) {\n                this.particles.push(newParticle);\n            }\n        }\n    }\n\n    getWavefunction(x, y, z, t) {\n        var total = 0;\n        for (var i = 0; i < this.superposition.length; i++) {\n            var phase = exp(complex(0, getEnergyLevel(this.superposition[i].n) * t));\n            total = add(total, multiply(phase, this.superposition[i].weight, getFunctional(this.superposition[i].n, this.superposition[i].l, this.superposition[i].m)(x, y, z)));\n        }\n        return total;\n    }\n\n    getProbabilityDistribution(x, y, z, t) {\n        var wavefunction = this.getWavefunction(x, y, z, t);\n        var wavefunctionC = wavefunction.conjugate();\n        return wavefunction * wavefunctionC;    \n    }\n\n    getWavefunctionGradient(x, y, z, t) {\n        var total = [0, 0, 0];\n        for (var i = 0; i < this.superposition.length; i++) {\n            var phase = exp(complex(0, getEnergyLevel(this.superposition[i].n) * t));\n            var grad = multiply(phase, this.superposition[i].weight, getGradient(this.superposition[i].n, this.superposition[i].l, this.superposition[i].m)(x, y, z));\n            total[0] = add(total[0], grad[0]);\n            total[1] = add(total[1], grad[1]);\n            total[2] = add(total[2], grad[2]);\n        }\n        return total;\n    }\n    \n    getVelocity(x, y, z, t) {\n        var wavefunction = this.getWavefunction(x, y, z, t);\n        var wavefunctionC = wavefunction.conjugate();\n        var gradient = this.getWavefunctionGradient(x, y, z, t);\n        var gradientC = [\n            gradient[0].conjugate(), \n            gradient[1].conjugate(), \n            gradient[2].conjugate(), \n        ];\n        var velocity = [\n            divide(subtract(multiply(wavefunction, gradientC[0]), multiply(wavefunctionC, gradient[0])), multiply(wavefunction, wavefunctionC)),\n            divide(subtract(multiply(wavefunction, gradientC[1]), multiply(wavefunctionC, gradient[1])), multiply(wavefunction, wavefunctionC)),\n            divide(subtract(multiply(wavefunction, gradientC[2]), multiply(wavefunctionC, gradient[2])), multiply(wavefunction, wavefunctionC))\n        ];\n        return velocity;\n    }\n\n    update(increment) {\n        var deltat = 0.001;\n        var p = this.particles[0];\n        for (var i = 0; i < this.particles.length; i++) {\n            var p = this.particles[i];\n            var velocity = this.getVelocity(p.x, p.y, p.z, this.timer);\n            var oldNorm = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n            p.move(velocity[0].im * deltat, velocity[1].im * deltat, velocity[2].im * deltat);\n            var newNorm = sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n            p.set(p.x * oldNorm / newNorm, p.y * oldNorm / newNorm, p.z * oldNorm / newNorm);\n        }\n        this.timer += 1;\n        return this;\n    }\n}\n\nexport default Atom;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}