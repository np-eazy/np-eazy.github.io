{"ast":null,"code":"import{X,Y,GRID_SIZE,T,G0,G1,BASE,RAD}from'./graphic-utils.js';function clip1d(a){return Math.min(Math.max(0,a),0.9999);}// The colors here are on unit scale to make calculations easier in lieu of importing utils/colors.js\nfunction componentToHex(c){var hex=c.toString(16);return hex.length==1?\"0\"+hex:hex;}function rgbToHex(r,g,b){return\"#\"+componentToHex(Math.floor(r*256))+componentToHex(Math.floor(g*256))+componentToHex(Math.floor(b*256));}function localToGlobal(c){return[G0[X]+(G1[X]-G0[X])*c[X]/GRID_SIZE[X],G0[Y]+(G1[Y]-G0[Y])*c[Y]/GRID_SIZE[Y]];}function drawLine(canvas,c1,c2,width,color){canvas.strokeStyle=color;canvas.lineWidth=width;canvas.beginPath();canvas.moveTo(c1[X],c1[Y]);canvas.lineTo(c2[X],c2[Y]);canvas.stroke();}function drawDiagCross(canvas,center,length,color){length=Math.max(0,length);if(length>0){drawLine(canvas,[center[X]-length,center[Y]-length],[center[X]+length,center[Y]+length],2,color);drawLine(canvas,[center[X]+length,center[Y]-length],[center[X]-length,center[Y]+length],2,color);}}var FoldGraphics=function FoldGraphics(_ref){var system=_ref.system;function render(canvas,grid,glow){var center;var length;for(var y=0;y<GRID_SIZE[Y];y++){for(var x=10;x<GRID_SIZE[X]-5;x++){length=BASE+RAD*grid.getVal(x,y)*2;center=localToGlobal([x+0.5,y+0.5]);// Get grid colors\nvar r=0.4+0.006*(x+y)+0.05*Math.sin(system.timer*0.24/T);var g=0.3+0.002*(x-y)+0.04*Math.cos(system.timer*0.48/T);var b=0.45-0.006*(x/2+y)-0.1*Math.sin(system.timer*0.89/T);// Invert if negative\nif(grid.getVal(x,y)<0){r=1-r;g=1-g;b=1-b;}// Render checkerboard of crosses\nif((x+y)%2==0){// Linear dodge for more engaging colors\nvar blur=Math.min(1,Math.max(0,glow-(y-25)/5));r=clip1d(r*(1+2*blur*grid.getVal(x,y)*grid.getVal(x,y)));g=clip1d(g*(1+1.5*blur*grid.getVal(x,y)*grid.getVal(x,y)));b=clip1d(b*(1+0.75*blur*grid.getVal(x,y)*grid.getVal(x,y)));var hex=rgbToHex(r,g,b);drawDiagCross(canvas,[center[X],center[Y]],Math.min(10,Math.abs(length)*1.3),hex);}}}}var canv=document.getElementById(\"fold-graphics\");var ctx=canv!=null?canv.getContext('2d'):null;if(ctx!=null&&system!=undefined){ctx.clearRect(G0[X],G0[Y],G1[X],G1[Y]);render(ctx,system.smoothGrid,8);}};export default FoldGraphics;","map":{"version":3,"names":["X","Y","GRID_SIZE","T","G0","G1","BASE","RAD","clip1d","a","Math","min","max","componentToHex","c","hex","toString","length","rgbToHex","r","g","b","floor","localToGlobal","drawLine","canvas","c1","c2","width","color","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","drawDiagCross","center","FoldGraphics","system","render","grid","glow","y","x","getVal","sin","timer","cos","blur","abs","canv","document","getElementById","ctx","getContext","undefined","clearRect","smoothGrid"],"sources":["/Users/joeyzhu/Projects/joey-j-zhu.github.io/src/components/fold/fold-graphics/fold-graphics.js"],"sourcesContent":["\nimport {X, Y, GRID_SIZE, T, G0, G1, BASE, RAD} from './graphic-utils.js';\n\nfunction clip1d(a) {\n    return Math.min(Math.max(0, a), 0.9999);\n}\n\n// The colors here are on unit scale to make calculations easier in lieu of importing utils/colors.js\nfunction componentToHex(c) {\n    var hex = c.toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nfunction rgbToHex(r, g, b) {\n    return \"#\" + componentToHex(Math.floor(r * 256)) + componentToHex(Math.floor(g * 256)) + componentToHex(Math.floor(b * 256));\n}\n\nfunction localToGlobal(c) {\n    return [G0[X] + (G1[X] - G0[X]) * c[X] / GRID_SIZE[X], G0[Y] + (G1[Y] - G0[Y]) * c[Y] / GRID_SIZE[Y]];\n}\n\nfunction drawLine(canvas, c1, c2, width, color) {\n    canvas.strokeStyle = color;\n    canvas.lineWidth = width;\n    canvas.beginPath();\n    canvas.moveTo(c1[X], c1[Y]);\n    canvas.lineTo(c2[X], c2[Y]);\n    canvas.stroke();\n}\n\nfunction drawDiagCross(canvas, center, length, color) {\n    length = Math.max(0, length);\n    if (length > 0) {\n        drawLine(canvas, \n            [center[X] - length, center[Y] - length], \n            [center[X] + length, center[Y] + length], \n            2, color);\n        drawLine(canvas, \n            [center[X] + length, center[Y] - length], \n            [center[X] - length, center[Y] + length], \n            2, color);\n    }\n}\n\nconst FoldGraphics = ({\n    system,\n}) => {\n    function render(canvas, grid, glow) {\n        var center;\n        var length;\n        for (var y = 0; y < GRID_SIZE[Y]; y++) {\n            for (var x = 10; x < GRID_SIZE[X]-5; x++) {\n                length = BASE + RAD * (grid.getVal(x, y)) * 2;\n                center = localToGlobal([x + 0.5, y + 0.5]);\n                \n                // Get grid colors\n                var r = 0.4 + 0.006 * (x + y) + 0.05 * Math.sin(system.timer * 0.24 / T);\n                var g = 0.3 + 0.002 * (x - y) + 0.04 * Math.cos(system.timer * 0.48 / T );\n                var b = 0.45 - 0.006 * (x / 2 + y) - 0.1 * Math.sin(system.timer * 0.89 / T);\n                \n                // Invert if negative\n                if (grid.getVal(x, y) < 0) {\n                    r = 1 - r;\n                    g = 1 - g;\n                    b = 1 - b;\n                }\n                \n                // Render checkerboard of crosses\n                if ((x + y) % 2 == 0) {\n                    // Linear dodge for more engaging colors\n                    var blur = Math.min(1, Math.max(0, glow - (y-25)/5));\n                    r = clip1d(r * (1 + 2 * blur * grid.getVal(x, y) * grid.getVal(x, y)));\n                    g = clip1d(g * (1 + 1.5 * blur * grid.getVal(x, y) * grid.getVal(x, y)));\n                    b = clip1d(b * (1 + 0.75 * blur * grid.getVal(x, y) * grid.getVal(x, y)));\n                    \n                    var hex = rgbToHex(r, g, b);\n                    drawDiagCross(canvas, [center[X], center[Y]], Math.min(10, Math.abs(length) * 1.3), hex);\n                }\n            }\n        }\n    }\n\n    var canv = document.getElementById(\"fold-graphics\");\n    var ctx = canv != null ? canv.getContext('2d') : null;\n\n    if (ctx != null && system != undefined) {\n        ctx.clearRect(G0[X], G0[Y], G1[X], G1[Y]);\n        render(ctx, system.smoothGrid, 8);\n    }\n};\n\nexport default FoldGraphics;\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}