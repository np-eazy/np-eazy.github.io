{"ast":null,"code":"import { coinFlip, randRange } from '../../../utils/functions';\nimport { complex, sqrt, exp } from 'mathjs';\nconst A0 = 1;\nfunction getFactorial(n) {\n  var soln = 1;\n  for (var i = 0; i < n; i++) {\n    soln *= i + 1;\n  }\n  return soln;\n}\nfunction mapToSpherical(x, y, z) {\n  var rho = sqrt(x * x + y * y + z * z);\n  var theta = Math.atan(y / x);\n  var phi = Math.acos(z / rho);\n  return rho, theta, phi;\n}\nfunction getNormalization(n, l) {\n  var constTerm = Math.sqrt(Math.pow(2 / (n * A0), 3) * getFactorial(n - l - 1) / (2 * n * getFactorial(n + l)));\n  var radius = rho => 2 * rho / (n * A0);\n  return rho => constTerm * Math.exp(radius(rho) / -2) * Math.pow(radius(rho), l);\n}\nfunction getLaguerrePolynomial(n, l) {\n  var a = 2 * l + 1;\n  var k = n - l - 1;\n  var memoTable = Array(n);\n  memoTable[0] = rho => 1;\n  memoTable[1] = rho => 1 + a - rho;\n  for (var i = 2; i < n; i++) {\n    memoTable[i] = rho => {\n      var leftTerm = (2 * k + a - rho) * memoTable[i - 1](rho);\n      var rightTerm = (k - a - 1) * memoTable[i - 2](rho);\n      return (leftTerm - rightTerm) / k;\n    };\n  }\n  return rho => memoTable[n - 1](rho) * getNormalization(n, l)(rho);\n}\nfunction getLegendrePolynomial(l, m) {\n  var memoTable = Array(l);\n  memoTable[0] = x => 1;\n  memoTable[1] = x => x;\n  for (var i = 2; i < l; i++) {\n    memoTable[i] = x => {\n      var leftTerm = x * (2 * l - 1) * memoTable[i - 1](x);\n      var rightTerm = (l + m - 1) * memoTable[i - 2](x);\n      return (leftTerm - rightTerm) / (l - m);\n    };\n  }\n  return memoTable[l - 1];\n}\nfunction getSphericalHarmonic(l, m) {\n  var sign = m % 2 == 0 ? 1 : -1;\n  var normalization = Math.sqrt(getFactorial(l - m) * (2 * l + 1) / (getFactorial(l + m) * 4 * Math.PI));\n  var exponent = phi => Math.exp(complex(0, m * phi));\n  return phi => sign * normalization * exponent(phi);\n}\nfunction getFunctional(n, l, m) {\n  return (x, y, z) => {\n    var rho,\n      theta,\n      phi = mapToSpherical(x, y, z);\n    return getLaguerrePolynomial(n, l)(rho) * getLegendrePolynomial(l, m)(Math.cos(theta)) * getSphericalHarmonic(l, m)(theta, phi);\n  };\n}\nfunction getGradient(n, l, m) {\n  var rhoTerm = getLaguerrePolynomial(n, l);\n  var delta = 0.01;\n  // TODO: Explicitly calculate functions for less computational load\n  return (x, y, z) => {\n    var rho,\n      theta,\n      phi = mapToSpherical(x, y, z);\n    var deltaRho = (getLaguerrePolynomial(n, l)(rho + delta / 2) - getLaguerrePolynomial(n, l)(rho - delta / 2)) / delta;\n    var deltaTheta = (getLegendrePolynomial(l, m)(theta + delta / 2) - getLegendrePolynomial(l, m)(theta - delta / 2)) / (delta * rho);\n    var deltaPhi = (getSphericalHarmonic(l, m)(phi + delta / 2) - getSphericalHarmonic(l, m)(phi - delta / 2)) / (delta * rho * Math.sin(theta));\n    var unitRho = [Math.sin(theta) * Math.cos(phi), Math.sin(theta) * Math.sin(phi), Math.cos(theta)];\n    var unitTheta = [Math.cos(theta) * Math.cos(phi), Math.cos(theta) * Math.sin(phi), Math.sin(theta) * -1];\n    var unitPhi = [Math.sin(phi) * -1, Math.cos(phi), 0];\n    return [unitRho[0] * deltaRho + unitTheta[0] * deltaTheta + unitPhi[0] * deltaPhi, unitRho[1] * deltaRho + unitTheta[1] * deltaTheta + unitPhi[1] * deltaPhi, unitRho[2] * deltaRho + unitTheta[2] * deltaTheta + unitPhi[2] * deltaPhi];\n  };\n}\nfunction getEnergyLevel(n) {\n  return 1 / (n * n);\n}\nclass Particle {\n  constructor(x, y, z) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n  }\n  move(dx, dy, dz) {\n    this.x += dx;\n    this.y += dy;\n    this.z = dz;\n  }\n}\nconst Atom = class {\n  constructor(props) {\n    this.superposition = props.superposition;\n    this.particleCount = props.particleCount;\n    this.boxSize = props.boxSize;\n    this.particles = [];\n    while (this.particles.length < props.particleCount) {\n      var newParticle = new Particle(randRange(props.boxSize * -1, props.boxSize), randRange(props.boxSize * -1, props.boxSize), randRange(props.boxSize * -1, props.boxSize));\n      if (coinFlip(this.getProbabilityDistribution(newParticle.x, newParticle.y, newParticle.z))) {\n        this.particles.push(newParticle);\n      }\n    }\n    console.log(this.particles);\n  }\n  getWavefunction(x, y, z, t) {\n    var total = 0;\n    for (var i = 0; i < this.superposition.length; i++) {\n      var phase = Math.exp(complex(0, getEnergyLevel(this.superposition[i].n) * t));\n      total += phase * this.superposition[i].weight * getFunctional(this.superposition[i].n, this.superposition[i].l, this.superposition[i].m)(x, y, z);\n    }\n    return total;\n  }\n  getProbabilityDistribution(x, y, z, t) {\n    var wavefunction = this.getWavefunction(x, y, z, t);\n    var wavefunctionC = complex.conjugate(wavefunction);\n    return wavefunction * wavefunctionC;\n  }\n  getWaveFunctionGradient(x, y, z, t) {\n    var total = [0, 0, 0];\n    for (var i = 0; i < this.superposition.length; i++) {\n      var phase = Math.exp(complex(0, getEnergyLevel(this.superposition[i].n) * t));\n      var grad = phase * this.superposition[i].weight * getGradient(this.superposition[i].n, this.superposition[i].l, this.superposition[i].m)(x, y, z);\n      total[0] += grad[0];\n      total[1] += grad[1];\n      total[2] += grad[2];\n    }\n    return total;\n  }\n  getVelocity(x, y, z, t) {\n    var wavefunction = this.getWavefunction(x, y, z, t);\n    var wavefunctionC = complex.conjugate(wavefunction);\n    var gradient = this.getWavefunctionGradient(x, y, z, t);\n    var gradientC = [complex.conjugate(gradient[0]), complex.conjugate(gradient[1]), complex.conjugate(gradient[2])];\n    var velocity = [(wavefunction * gradientC[0] - wavefunctionC * gradient[0]) / (wavefunction * wavefunctionC), (wavefunction * gradientC[1] - wavefunctionC * gradient[1]) / (wavefunction * wavefunctionC), (wavefunction * gradientC[2] - wavefunctionC * gradient[2]) / (wavefunction * wavefunctionC)];\n    return velocity;\n  }\n  update(increment) {\n    for (var i = 0; i < this.particles.length; i++) {\n      var p = this.particles[i];\n      var velocity = this.getVelocity(p.x, p.y, p.z);\n      p.move(velocity[0], velocity[1], velocity[2]);\n    }\n    this.timer += increment;\n    var p = this.particles[0];\n    var velocity = this.getVelocity(p.x, p.y, p.z);\n    console.log(velocity);\n    return this;\n  }\n};\nexport default Atom;","map":{"version":3,"names":["coinFlip","randRange","complex","sqrt","exp","A0","getFactorial","n","soln","i","mapToSpherical","x","y","z","rho","theta","Math","atan","phi","acos","getNormalization","l","constTerm","pow","radius","getLaguerrePolynomial","a","k","memoTable","Array","leftTerm","rightTerm","getLegendrePolynomial","m","getSphericalHarmonic","sign","normalization","PI","exponent","getFunctional","cos","getGradient","rhoTerm","delta","deltaRho","deltaTheta","deltaPhi","sin","unitRho","unitTheta","unitPhi","getEnergyLevel","Particle","constructor","move","dx","dy","dz","Atom","props","superposition","particleCount","boxSize","particles","length","newParticle","getProbabilityDistribution","push","console","log","getWavefunction","t","total","phase","weight","wavefunction","wavefunctionC","conjugate","getWaveFunctionGradient","grad","getVelocity","gradient","getWavefunctionGradient","gradientC","velocity","update","increment","p","timer"],"sources":["/Users/joeyzhu/Projects/joey-j-zhu.github.io/src/components/fold/fold-graphics/atom.js"],"sourcesContent":["import { coinFlip, randRange, } from '../../../utils/functions';\nimport { complex, sqrt, exp } from 'mathjs';\n\n\nconst A0 = 1;\n\nfunction getFactorial(n) {\n    var soln = 1;\n    for (var i = 0; i < n; i++) {\n        soln *= i + 1;\n    }\n    return soln;\n}\n\nfunction mapToSpherical(x, y, z) {\n    var rho = sqrt(x * x + y * y + z * z);\n    var theta = Math.atan(y / x);\n    var phi = Math.acos(z / rho);\n    return (rho, theta, phi);\n}\n\nfunction getNormalization(n, l) {\n    var constTerm = Math.sqrt(Math.pow(2 / (n * A0), 3) * getFactorial(n - l - 1) / (2 * n * getFactorial(n + l)));\n    var radius = (rho) => (2 * rho) / (n * A0);\n    return (rho) => constTerm * Math.exp(radius(rho) / -2) * Math.pow(radius(rho), l);\n}\n\n\nfunction getLaguerrePolynomial(n, l) {\n    var a = 2 * l + 1;\n    var k = n - l - 1;\n    var memoTable = Array(n);\n    memoTable[0] = (rho) => 1;\n    memoTable[1] = (rho) => (1 + a - rho);\n    for (var i = 2; i < n; i++) {\n        memoTable[i] = (rho) => {\n            var leftTerm = (2 * k + a - rho) * memoTable[i - 1](rho);\n            var rightTerm = (k - a - 1) * memoTable[i - 2](rho);\n            return (leftTerm - rightTerm) / k;\n        }\n    }\n    return (rho) => memoTable[n - 1](rho) * getNormalization(n, l)(rho);\n}\n\nfunction getLegendrePolynomial(l, m) {\n    var memoTable = Array(l);\n    memoTable[0] = (x) => 1;\n    memoTable[1] = (x) => x;\n    for (var i = 2; i < l; i++) {\n        memoTable[i] = (x) => {\n            var leftTerm = x * (2 * l - 1) * memoTable[i - 1](x);\n            var rightTerm = (l + m - 1) * memoTable[i - 2](x);\n            return (leftTerm - rightTerm) / (l - m);\n        }\n    }\n    return memoTable[l - 1];\n}\n\nfunction getSphericalHarmonic(l, m) {\n    var sign = m % 2 == 0 ? 1 : -1;\n    var normalization = Math.sqrt((getFactorial(l - m) * (2 * l + 1)) / (getFactorial(l + m) * 4 * Math.PI));\n    var exponent = (phi) => Math.exp(complex(0, m * phi));\n\n    return (phi) => (sign * normalization * exponent(phi));\n}\n\n\nfunction getFunctional(n, l, m) {\n    return (x, y, z) => {\n        var rho, theta, phi = mapToSpherical(x, y, z);\n        return getLaguerrePolynomial(n, l)(rho) * getLegendrePolynomial(l, m)(Math.cos(theta)) * getSphericalHarmonic(l, m)(theta, phi);\n    };\n}\n\nfunction getGradient(n, l, m) {\n    var rhoTerm = getLaguerrePolynomial(n, l);\n    var delta = 0.01;\n    // TODO: Explicitly calculate functions for less computational load\n    return (x, y, z) => {\n        var rho, theta, phi = mapToSpherical(x, y, z);\n\n        var deltaRho = (getLaguerrePolynomial(n, l)(rho + delta / 2) - getLaguerrePolynomial(n, l)(rho - delta / 2)) / (delta);\n        var deltaTheta = (getLegendrePolynomial(l, m)(theta + delta / 2) - getLegendrePolynomial(l, m)(theta - delta / 2)) / (delta * rho);\n        var deltaPhi = (getSphericalHarmonic(l, m)(phi + delta / 2) - getSphericalHarmonic(l, m)(phi - delta / 2)) / (delta * rho * Math.sin(theta));\n\n        var unitRho = [Math.sin(theta) * Math.cos(phi), Math.sin(theta) * Math.sin(phi), Math.cos(theta)];\n        var unitTheta = [Math.cos(theta) * Math.cos(phi), Math.cos(theta) * Math.sin(phi), Math.sin(theta) * -1];\n        var unitPhi = [Math.sin(phi) * -1, Math.cos(phi), 0];\n\n        return [\n            unitRho[0] * deltaRho + unitTheta[0] * deltaTheta + unitPhi[0] * deltaPhi,\n            unitRho[1] * deltaRho + unitTheta[1] * deltaTheta + unitPhi[1] * deltaPhi,\n            unitRho[2] * deltaRho + unitTheta[2] * deltaTheta + unitPhi[2] * deltaPhi,\n        ];\n    }\n}\n\nfunction getEnergyLevel(n) {\n    return 1 / (n * n);\n}\n\n\nclass Particle {\n    constructor(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n\n    move(dx, dy, dz) {\n        this.x += dx;\n        this.y += dy;\n        this.z = dz;\n    }\n}\n\n\nconst Atom = class {\n    constructor (props) {\n        this.superposition = props.superposition;\n        this.particleCount = props.particleCount;\n        this.boxSize = props.boxSize;\n\n        this.particles = [];\n        while (this.particles.length < props.particleCount) {\n            var newParticle = new Particle(\n                randRange(props.boxSize * -1, props.boxSize),\n                randRange(props.boxSize * -1, props.boxSize),\n                randRange(props.boxSize * -1, props.boxSize),\n            )\n            if (coinFlip(this.getProbabilityDistribution(newParticle.x, newParticle.y, newParticle.z))) {\n                this.particles.push(newParticle);\n            }\n        }\n        console.log(this.particles);\n    }\n\n    getWavefunction(x, y, z, t) {\n        var total = 0;\n        for (var i = 0; i < this.superposition.length; i++) {\n            var phase = Math.exp(complex(0, getEnergyLevel(this.superposition[i].n) * t));\n            total += phase * this.superposition[i].weight * getFunctional(this.superposition[i].n, this.superposition[i].l, this.superposition[i].m)(x, y, z);\n        }\n        return total\n    }\n\n    getProbabilityDistribution(x, y, z, t) {\n        var wavefunction = this.getWavefunction(x, y, z, t);\n        var wavefunctionC = complex.conjugate(wavefunction);\n        return wavefunction * wavefunctionC;    \n    }\n\n    getWaveFunctionGradient(x, y, z, t) {\n        var total = [0, 0, 0];\n        for (var i = 0; i < this.superposition.length; i++) {\n            var phase = Math.exp(complex(0, getEnergyLevel(this.superposition[i].n) * t));\n            var grad = phase * this.superposition[i].weight * getGradient(this.superposition[i].n, this.superposition[i].l, this.superposition[i].m)(x, y, z);\n            total[0] += grad[0];\n            total[1] += grad[1];\n            total[2] += grad[2];\n        }\n        return total;\n    }\n    \n    getVelocity(x, y, z, t) {\n        var wavefunction = this.getWavefunction(x, y, z, t);\n        var wavefunctionC = complex.conjugate(wavefunction);\n        var gradient = this.getWavefunctionGradient(x, y, z, t);\n        var gradientC = [\n            complex.conjugate(gradient[0]), \n            complex.conjugate(gradient[1]),\n            complex.conjugate(gradient[2]),\n        ]\n        var velocity = [\n            (wavefunction * gradientC[0] - wavefunctionC * gradient[0]) / (wavefunction * wavefunctionC),\n            (wavefunction * gradientC[1] - wavefunctionC * gradient[1]) / (wavefunction * wavefunctionC),\n            (wavefunction * gradientC[2] - wavefunctionC * gradient[2]) / (wavefunction * wavefunctionC),\n        ]\n        return velocity;\n    }\n\n    update(increment) {\n        for (var i = 0; i < this.particles.length; i++) {\n            var p = this.particles[i];\n            var velocity = this.getVelocity(p.x, p.y, p.z);\n            p.move(velocity[0], velocity[1], velocity[2]);\n        }\n        this.timer += increment;\n\n        var p = this.particles[0];\n        var velocity = this.getVelocity(p.x, p.y, p.z);\n        console.log(velocity);\n        return this;\n    }\n}\n\nexport default Atom;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}